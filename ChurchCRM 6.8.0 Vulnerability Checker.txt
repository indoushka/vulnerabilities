=============================================================================================================================================
| # Title     : ChurchCRM 6.8.0 Vulnerability Checker                                                                                       |
| # Author    : indoushka                                                                                                                   |
| # Tested on : windows 11 Fr(Pro) / browser : Mozilla firefox 147.0.3 (64 bits)                                                            |
| # Vendor    : https://github.com/ChurchCRM/                                                                                               |
=============================================================================================================================================

[+] Summary    : A vulnerability in ChurchCRM versions 6.8.0 and earlier affects the installation (/setup/) endpoint. 
                 When accessible, the setup process may allow unauthorized interaction and expose version information via the CRM-VERSION HTTP header.
                 If the setup procedure is not properly disabled after installation, an attacker could potentially abuse unsanitized configuration 
				 inputs to inject malicious PHP code into the Include/Config.php file. Because this configuration file is executed by the application, such injection could result in Remote Code Execution (RCE).
                 he issue stems from improper input validation during the installation workflow and unsafe handling of user-controlled configuration values.

[+] POC : 

#!/usr/bin/env python3
import requests
import sys
from urllib.parse import urljoin

def check_target(base_url):
    try:
        setup_url = urljoin(base_url, "setup/")
        print(f"[+] Checking: {setup_url}")

        response = requests.get(setup_url, timeout=10, allow_redirects=True)

        if response.status_code not in [200, 301, 302]:
            print("[-] Target not reachable or setup page inaccessible")
            return

        version = response.headers.get("CRM-VERSION")

        if version:
            print(f"[+] Detected CRM Version: {version}")
            if version <= "6.8.0":
                print("[!] Potentially Vulnerable Version Detected")
            else:
                print("[+] Version appears safe")
        else:
            print("[?] CRM-VERSION header not found")
            print("[?] Manual verification required")

    except requests.exceptions.RequestException as e:
        print(f"[-] Error: {e}")

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print(f"Usage: {sys.argv[0]} http://target")
        sys.exit(1)

    check_target(sys.argv[1])

		
Greetings to :======================================================================
jericho * Larry W. Cashdollar * r00t * Hussin-X * Malvuln (John Page aka hyp3rlinx)|
====================================================================================